# 容斥原理及应用

## EX1

> Find the number of integers between 1 and 10,000 inclusive that are not divisible by 4,5, or 6.

本题写的详细些，后面类似的题目就不再解释太多细节。

设$A_i, i=1,2,3$分别为1到10，000之间能被4、5和6整除的个数。

计算集合大小时采用**向下取整**，例如$\lfloor \dfrac{10000}{6} = 1666 \rfloor$，表明还取不到下一个6的倍数。

| set | size |
| :-----: | :-----:|
| $A_1$ | 2500 |
|$A_2$ | 2000 |
|$A_3$ | 1666 |
|$A_1 \cap A_2$ | 500 |
|$A_1 \cap A_3$ | 833 |
|$A_2 \cap A_3$ | 333 |
|$A_1 \cap A_2 \cap A_3$ | 166 |

$$
\begin{aligned}
    |\overline{A_1} \cap \overline{A_2} \cap \overline{A_3}| =& |S| - \sum |A_i| + \sum |A_iA_j| - \sum|A_iA_jA_k| \\
    =& 10000 - (2500+2000 + 1666) +(500+833 + 333) - 166 \\
    =& 5334
\end{aligned}
$$

## EX2

> Find the number of integers between 1 and 10,000 inclusive that are not divisible by 4, 6, 7, or 10.

### 验证代码

```cpp
#include <iostream>
#include <vector>

using namespace std;

int main()
{
    int cnt = 0;
    vector<int> arr{4, 6, 7, 10};
    for(int i = 1; i <= 10000; ++ i) {
        bool flag = true;
        for(auto item: arr) {
            if(i%item == 0) {
                flag = false;
                break;
            }
        }
        if(flag) {
            printf("%d ", i);
            cnt ++;
            if(cnt % 20 == 0) printf("\n");
        }
    }
    printf("\nTotal number = %d\n", cnt);
    return 0;
}
```

## EX3

> Find the number of integers between 1 and 10,000 that are neither perfect squares nor perfect cubes.

既是完全平方数也是完全立方数的数一定能拆分成6个相同数的乘积。

计算满足$x^2 \le 10000, \quad y^3 \le 10000, \quad z^6 \le 10000$的最大整数解，得$x=100, y = 21, z = 4$。

| set | size |
| :-----: | :-----:|
| $A_1$ | 100 |
|$A_2$ | 21 |
|$A_1 \cap A_2$ | 4 |

$$
\begin{aligned}
    |\overline{A_1} \cap \overline{A_2} | =& |S| - \sum |A_i| + \sum |A_iA_j|\\
    =& 10000 - (100+21) + 4 \\
    =& 9883
\end{aligned}
$$

## EX4

> Determine the number of 12-combinations of the multiset 
> $$
> S = \{4 \cdot a, 3 \cdot b, 4 \cdot c, 5 \cdot d\}
> $$

多重集合的组合与方程的非负整数解个数等价，因此，满足

$$
0 \le x_1 \le 4, 0 \le x_2 \le 3, 0 \le x_3 \le 4, 0 \le x_4 \le 5
$$
的方程
$$
x_1 + x_2 + x_3 + x_4 = 12
$$

设$A_i, i = 1,2,3,4$分别是满足$x_1 \ge 5, x_2 \ge 4, x_3 \ge 5, x_4 \ge 6$的解组成的集合。

求满足$x_1 \ge 5$的解，进行变量代换$y_1 = x_1 - 5, y_2 = x_2, y_3 = x_3 , y_4 = x_4$，方程转化为

$$
y_1 + y_2 + y_3 + y_4 = 7
$$

此时方程的解个数为$\dbinom{7+4-1}{7} = 120$，即$|A_1| = 120$。
同理可以计算$|A_2| = 165, |A_3| = 120, |A_4| = 84$。

求满足$x_1 \ge 5, x_2 \ge 4$的解，进行变量代换$y_1 = x_1 - 5, y_2 = x_2-4, y_3 = x_3 , y_4 = x_4$，方程转化为

$$
y_1 + y_2 + y_3 + y_4 = 3
$$

此时方程的解个数为$\dbinom{3+4-1}{3} = 20$，即$|A_1 \cap A_2 | = 20$。

因此可以求出

| set | size |
| :-----: | :-----:|
| $A_1$ | 120 |
|$A_2$ | 165 |
|$A_3$ | 120 |
|$A_4$ | 84 |
|$A_1 \cap A_2$ | 20 |
|$A_1 \cap A_3$ | 10 |
|$A_1 \cap A_4$ | 4 |
|$A_2 \cap A_3$ | 20 |
|$A_2 \cap A_4$ | 10 |
|$A_3 \cap A_4$ | 4 |
|$A_1 \cap A_2 \cap A_3$ | 0 |
|$A_1 \cap A_2 \cap A_4$ | 0 |
|$A_1 \cap A_3 \cap A_4$ | 0 |
|$A_2 \cap A_3 \cap A_4$ | 0 |
|$A_1 \cap A_2 \cap A_3 \cap A_4$ | 0 |

$$
\begin{aligned}
    |\overline{A_1} \cap \overline{A_2} \cap \overline{A_3} \cap \overline{A_4} | =& |S| - \sum |A_i| + \sum |A_iA_j| - \sum|A_iA_jA_k| + \sum|A_iA_jA_kA_u| \\
    =& 455 - (120 + 165 + 120 + 84) + (20 + 10 + 4 + 20 + 10 + 4) \\
    =& 34
\end{aligned}
$$